<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Paulinos spinta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --pastel-green: #d7fbe8;
      --outline: #3d6652;
      --highlight: #b2e5c8;
    }
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: var(--pastel-green);
      display: flex;
      flex-direction: column;
      font-family: 'Segoe UI', Arial, sans-serif;
      color: #29443a;
    }
    header {
      text-align: center;
      padding: 32px 0 12px 0;
      font-size: 2.5rem;
      font-weight: bold;
      letter-spacing: 2px;
      background: transparent;
    }
    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: stretch;
      position: relative;
      gap: 32px;
      min-height: 400px;
    }
    .human-container {
      position: relative;
      width: 260px;
      height: 500px;
      display: flex;
      justify-content: center;
      align-items: center;
      background: none;
      margin: 0 auto;
    }
    /* Overlay buttons on SVG */
    .part-btn {
      position: absolute;
      background: rgba(220, 255, 241, 0.28);
      border: 2px dashed #6fdca2;
      cursor: pointer;
      transition: background 0.2s, border-color 0.2s;
      z-index: 2;
      outline: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4em;
      color: #3d6652;
      opacity: 0.8;
    }
    .part-btn:focus {
      border-color: #3d6652;
      background: rgba(104, 194, 141, 0.18);
    }
    .part-btn:hover {
      background: rgba(104, 194, 141, 0.13);
      border-color: #3d6652;
    }
    .btn-head { left: 90px; top: 20px; width: 80px; height: 80px; border-radius: 50%; }
    .btn-upper { left: 70px; top: 90px; width: 120px; height: 110px; border-radius: 50px; }
    .btn-legs { left: 100px; top: 200px; width: 60px; height: 180px; border-radius: 30px; }
    .btn-feet { left: 100px; top: 380px; width: 60px; height: 70px; border-radius: 20px; }

    /* Masked images for each part */
    .part-img {
      position: absolute;
      object-fit: cover;
      z-index: 1;
      pointer-events: none;
    }
    .img-head {
      left: 90px; top: 20px; width: 80px; height: 80px;
      border-radius: 50%;
      clip-path: ellipse(40px 40px at 40px 40px);
    }
    .img-upper {
      left: 70px; top: 90px; width: 120px; height: 110px;
      border-radius: 50px;
      clip-path: inset(0 round 50px);
    }
    .img-legs {
      left: 100px; top: 200px; width: 60px; height: 180px;
      border-radius: 30px;
      clip-path: inset(0 round 30px);
    }
    .img-feet {
      left: 100px; top: 380px; width: 60px; height: 70px;
      border-radius: 20px;
      clip-path: ellipse(30px 35px at 30px 35px);
    }

    /* Outfit labels */
    .outfit-label {
      pointer-events: none;
      font-size: 1rem;
      color: #29443a;
      box-shadow: 0 1px 4px rgba(60,60,60,0.08);
      font-weight: bold;
      background: rgba(255,255,255,0.68);
      border-radius: 6px;
      position: absolute;
      width: 70px;
      text-align: center;
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      padding: 2px 0;
      user-select: none;
    }
    .label-head { top: 58px;}
    .label-upper { top: 155px;}
    .label-legs { top: 300px;}
    .label-feet { top: 445px;}

    /* Sidebar for controls */
    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 18px;
      background: rgba(255,255,255,0.45);
      border-radius: 18px;
      padding: 24px 18px;
      min-width: 210px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.05);
      align-self: flex-start;
      max-height: 90vh;
      overflow-y: auto;
    }
    .sidebar button {
      padding: 10px 14px;
      border: none;
      border-radius: 8px;
      background: var(--highlight);
      color: #29443a;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.18s;
      margin-bottom: 2px;
    }
    .sidebar button:hover, .sidebar button:focus {
      background: #b2e7c9;
      outline: 2px solid #3d6652;
    }
    .preset-list {
      margin-top: 7px;
      list-style: none;
      padding: 0;
      max-height: 120px;
      overflow-y: auto;
    }
    .preset-list li {
      background: #e8fff3;
      margin-bottom: 4px;
      padding: 5px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.98rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 4px;
    }
    .preset-list li:hover {
      background: #c5ecd7;
    }
    .preset-action-btn {
      background: none;
      border: none;
      color: #3d6652;
      font-size: 1.1em;
      cursor: pointer;
      padding: 0 5px;
      transition: color 0.15s;
      border-radius: 3px;
      margin-left: 6px;
    }
    .preset-action-btn:hover {
      color: #ce3b3b;
      background: #fbe8e8;
    }

    /* Upload buttons */
    .upload-btn {
      position: absolute;
      z-index: 10;
      background: rgba(240,255,240,0.8);
      border: 1px solid #b2e5c8;
      border-radius: 8px;
      font-size: 1.1em;
      padding: 2px 7px;
      color: #29443a;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0.85;
      cursor: pointer;
      transition: background 0.15s;
      min-width: 34px;
      text-align: center;
      box-shadow: 0 2px 6px rgba(60,60,60,0.04);
    }
    .upload-btn:hover, .upload-btn:focus {
      background: #b2e7c9;
      outline: 2px solid #3d6652;
    }
    .upload-head { top: 8px; }
    .upload-upper { top: 88px;}
    .upload-legs { top: 184px;}
    .upload-feet { top: 360px;}
    input[type="file"] { display: none; }

    footer {
      text-align: center;
      font-size: 1.05rem;
      margin: 0;
      padding: 20px;
      background: transparent;
      color: #29443a;
    }

    /* --- MOBILE --- */
    @media (max-width: 700px) {
      main {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
        min-height: unset;
      }
      .sidebar {
        min-width: unset;
        width: 100%;
        max-width: 100vw;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 14px;
        align-self: stretch;
        padding: 16px 4vw;
        justify-content: space-between;
      }
      .human-container {
        width: 95vw;
        max-width: 330px;
        height: 60vw;
        max-height: 70vw;
        min-height: 320px;
      }
      svg {
        width: 100% !important;
        height: auto !important;
      }
      .outfit-label,
      .img-head,
      .img-upper,
      .img-legs,
      .img-feet,
      .btn-head,
      .btn-upper,
      .btn-legs,
      .btn-feet,
      .upload-btn {
        /* scale down for mobile */
        transform: scale(0.8) translateX(-62.5%);
        left: 62.5%;
      }
      .preset-list {
        max-height: 60px;
      }
    }
  </style>
</head>
<body>
  <header>
    Paulinos spinta
  </header>
  <main>
    <div class="human-container">
      <svg width="260" height="500" viewBox="0 0 260 500" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute; left: 0; top: 0;">
        <!-- Head -->
        <ellipse cx="130" cy="60" rx="38" ry="38" stroke="var(--outline)" stroke-width="5" fill="none"/>
        <!-- Upper body -->
        <rect x="80" y="98" width="100" height="120" rx="45" stroke="var(--outline)" stroke-width="5" fill="none"/>
        <!-- Legs -->
        <rect x="110" y="218" width="40" height="180" rx="19" stroke="var(--outline)" stroke-width="5" fill="none"/>
        <!-- Feet -->
        <ellipse cx="130" cy="445" rx="34" ry="25" stroke="var(--outline)" stroke-width="5" fill="none"/>
      </svg>
      <!-- Image overlays for parts -->
      <img id="img-head"    class="part-img img-head"    alt="Head"    hidden>
      <img id="img-upper"   class="part-img img-upper"   alt="Upper"   hidden>
      <img id="img-legs"    class="part-img img-legs"    alt="Legs"    hidden>
      <img id="img-feet"    class="part-img img-feet"    alt="Feet"    hidden>
      <!-- Upload buttons for each part and hidden file inputs -->
      <button class="upload-btn upload-head" onclick="triggerFile('head')" title="Upload photo for head">📷</button>
      <input type="file" accept="image/*" id="file-head" onchange="handlePhoto('head')">
      <button class="upload-btn upload-upper" onclick="triggerFile('upper')" title="Upload photo for upper body">📷</button>
      <input type="file" accept="image/*" id="file-upper" onchange="handlePhoto('upper')">
      <button class="upload-btn upload-legs" onclick="triggerFile('legs')" title="Upload photo for legs">📷</button>
      <input type="file" accept="image/*" id="file-legs" onchange="handlePhoto('legs')">
      <button class="upload-btn upload-feet" onclick="triggerFile('feet')" title="Upload photo for feet">📷</button>
      <input type="file" accept="image/*" id="file-feet" onchange="handlePhoto('feet')">
      <!-- Transparent, but visible, buttons for each body part -->
      <button class="part-btn btn-head" aria-label="Choose hat or headwear" title="Choose hat or headwear" onclick="choosePart('head')">👒</button>
      <button class="part-btn btn-upper" aria-label="Choose shirt or dress" title="Choose shirt or dress" onclick="choosePart('upper')">👕</button>
      <button class="part-btn btn-legs" aria-label="Choose pants or skirt" title="Choose pants or skirt" onclick="choosePart('legs')">👖</button>
      <button class="part-btn btn-feet" aria-label="Choose shoes" title="Choose shoes" onclick="choosePart('feet')">👟</button>
    </div>
    <div class="sidebar">
      <button onclick="randomizeOutfit()" aria-label="Randomize outfit">🎲 Randomize</button>
      <button onclick="savePreset()" aria-label="Save current outfit as preset">💾 Save Preset</button>
      <label style="margin-bottom:0.3em;">Preset Library:</label>
      <ul class="preset-list" id="presetList"></ul>
    </div>
  </main>
  <footer>
    Spinta atnaujinta 2025-08-11
  </footer>
  <script>
    // --- Outfit logic and persistence ---
    let outfit = { head: null, upper: null, legs: null, feet: null };
    let outfitPhotos = { head: null, upper: null, legs: null, feet: null };

    let presets = [];
    // Load presets from localStorage
    function loadPresets() {
      try {
        const data = localStorage.getItem('presets');
        if (data) {
          presets = JSON.parse(data);
        }
      } catch (e) {
        presets = [];
      }
    }
    // Save presets to localStorage
    function persistPresets() {
      localStorage.setItem('presets', JSON.stringify(presets));
    }

    // Options for each part
    const partOptions = {
      head: ['Cap', 'Hat', 'Bandana', 'Nothing'],
      upper: ['T-shirt', 'Jacket', 'Dress', 'Sweater', 'Shirt'],
      legs: ['Jeans', 'Skirt', 'Shorts', 'Trousers'],
      feet: ['Sneakers', 'Boots', 'Sandals', 'Dress shoes']
    };

    // --- UI Logic ---

    function choosePart(part) {
      let options = partOptions[part] || [];
      let msg = `Choose for ${part}:\n`;
      options.forEach((opt, idx) => { msg += `${idx + 1}. ${opt}\n`; });
      let choice = prompt(msg, outfit[part] || "");
      if (!choice) return;
      let idx = Number(choice) - 1;
      if (!isNaN(idx) && idx >= 0 && idx < options.length) {
        outfit[part] = options[idx];
      } else if (options.includes(choice)) {
        outfit[part] = choice;
      } else {
        alert("Not a valid option.");
        return;
      }
      displayOutfit();
    }

    function randomizeOutfit() {
      for (let part in outfit) {
        const options = partOptions[part];
        outfit[part] = options[Math.floor(Math.random() * options.length)];
      }
      displayOutfit();
    }

    function savePreset() {
      const name = prompt('Enter a name for this outfit preset:');
      if (name) {
        presets.push({ name, outfit: { ...outfit }, photos: { ...outfitPhotos } });
        persistPresets();
        updatePresetList();
      }
    }

    function updatePresetList() {
      const ul = document.getElementById('presetList');
      ul.innerHTML = '';
      presets.forEach((preset, idx) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span style="flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${preset.name}</span>
          <button class="preset-action-btn" aria-label="Load preset ${preset.name}" title="Load preset" onclick="loadPreset(${idx})">⏎</button>
          <button class="preset-action-btn" aria-label="Delete preset ${preset.name}" title="Delete preset" onclick="deletePreset(${idx})">🗑</button>
        `;
        ul.appendChild(li);
      });
    }

    function loadPreset(idx) {
      if (presets[idx]) {
        outfit = { ...presets[idx].outfit };
        outfitPhotos = { ...presets[idx].photos };
        displayOutfit();
        displayPhotos();
      }
    }

    function deletePreset(idx) {
      if (confirm(`Delete preset "${presets[idx].name}"?`)) {
        presets.splice(idx, 1);
        persistPresets();
        updatePresetList();
      }
    }

    // --- Display outfit labels on figure ---
    function displayOutfit() {
      document.querySelectorAll('.outfit-label').forEach(el => el.remove());
      const container = document.querySelector('.human-container');
      const labelMap = {
        head: { class: 'label-head', val: outfit.head },
        upper: { class: 'label-upper', val: outfit.upper },
        legs: { class: 'label-legs', val: outfit.legs },
        feet: { class: 'label-feet', val: outfit.feet }
      };
      Object.entries(labelMap).forEach(([part, {class: cls, val}]) => {
        if (val) {
          const span = document.createElement('span');
          span.className = `outfit-label ${cls}`;
          span.textContent = val;
          container.appendChild(span);
        }
      });
    }

    // --- PHOTO UPLOAD logic ---
    function triggerFile(part) {
      document.getElementById('file-' + part).click();
    }

    function handlePhoto(part) {
      const input = document.getElementById('file-' + part);
      const file = input.files && input.files[0];
      if (!file) return;
      if (!file.type.startsWith('image/')) {
        alert('Please upload an image file!');
        return;
      }
      // Optionally limit file size
      if (file.size > 2 * 1024 * 1024) {
        alert('Image too large! Max size: 2MB');
        return;
      }
      const reader = new FileReader();
      reader.onload = async function(e) {
        outfitPhotos[part] = e.target.result; // Data URL
        displayPhotos();

        // --- GITHUB REPO UPLOAD INTEGRATION ---
        // To upload to your repo, you must POST this image (e.target.result) to your backend,
        // which will then use GitHub API to PUT/POST the file in your desired path.
        // For security, never expose a GitHub token in the browser!
        // For demo, this only saves locally.
        // Example: await uploadPhotoToGitHub(part, file);
      }
      reader.readAsDataURL(file);
    }

    function displayPhotos() {
      ['head','upper','legs','feet'].forEach(part => {
        const img = document.getElementById('img-' + part);
        if (outfitPhotos[part]) {
          img.src = outfitPhotos[part];
          img.hidden = false;
        } else {
          img.hidden = true;
        }
      });
    }

    // Placeholder for GitHub photo upload
    async function uploadPhotoToGitHub(part, file) {
      // Not implemented: you need a backend or GitHub Action for this!
      // 1. Send 'file' to your backend (e.g. POST via fetch)
      // 2. Backend authenticates and uploads to your repo: e.g. /wardrobe-images/{part}-{Date.now()}.jpg
      // 3. Backend returns the image URL or path in the repo.
      // 4. You can store this URL instead of the DataURL in outfitPhotos[part]
    }

    // --- Initial load ---
    loadPresets();
    updatePresetList();
    displayOutfit();
    displayPhotos();

    // Save current outfit and images in localStorage for session persistence
    window.addEventListener('beforeunload', () => {
      localStorage.setItem('currentOutfit', JSON.stringify(outfit));
      localStorage.setItem('currentPhotos', JSON.stringify(outfitPhotos));
    });
    window.addEventListener('DOMContentLoaded', () => {
      const saved = localStorage.getItem('currentOutfit');
      const savedPhotos = localStorage.getItem('currentPhotos');
      if (saved) {
        try {
          outfit = JSON.parse(saved);
          displayOutfit();
        } catch(e){}
      }
      if (savedPhotos) {
        try {
          outfitPhotos = JSON.parse(savedPhotos);
          displayPhotos();
        } catch(e){}
      }
    });
  </script>
</body>
</html>